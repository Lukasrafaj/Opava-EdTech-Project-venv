{% extends "base.html" %}
{% block title %}Login{% endblock %}



{% block content_section %}

<div class="div-settings-container">

    <div class="div-settings-menu">
                <div class="divider"></div>
                <button class="menu-item" id="NameChange">
                    <span class="menu-icon">&#128100;</span>
                    <span>Name</span>
                </button>
                <div class="divider"></div>
                <button class="menu-item" id="EmailChange">
                    <span class="menu-icon">&#128231;</span>
                    <span>Email</span>
                </button>
                <div class="divider"></div>
                <button class="menu-item" id="PasswordChange">
                    <span class="menu-icon">&#128274;</span>
                    <span>Password</span>
                </button>
                <div class="divider"></div>
                <button class="menu-item" id="LanguageChange">
                    <span class="menu-icon">{{ flags[current_locale] }}</span>
                    <span>Language</span>
                </button>
                <div class="divider"></div>

    </div>
   
   
    <div class="div-settings-content">

        <div class = "div-sign-up-container">
            
            <h1 class = "header-sign-up" align="center">Select language</h1>
            <div class="divider"></div>
                <div class="div-register-form">
                    
                        <label class="label-register" for="localeSelect">Choose a locale:</label>
                        <select class="input-register" id="localeSelect">
                            <option value="{{ url_for('lang.set_language', lang='en') }}">ðŸ‡¬ðŸ‡§ English</option>
                            <option value="{{ url_for('lang.set_language', lang='cs') }}">ðŸ‡¨ðŸ‡¿ Czech</option>
                            <option value="{{ url_for('lang.set_language', lang='sk') }}">ðŸ‡¸ðŸ‡° Slovak</option>
                        </select>
                    
                </div>
        </div>
        
        
        <script>
                    const currentLocale = "{{ session.get('lang', 'en') }}";
                    const localeSelect = document.getElementById('localeSelect');
                    
                    console.log('Current locale from session:', currentLocale);
                    
                    // Set the selected option based on current locale
                    const options = localeSelect.querySelectorAll('option');
                    options.forEach((option, index) => {
                        // Extract language code from the URL (e.g., /lang/set_language/cs -> cs)
                        const url = option.value;
                        const lang = url.split('/').pop(); // Get the last part of the URL
                        
                        console.log(`Option ${index}: url="${url}", extracted lang="${lang}", matches: ${currentLocale === lang}`);
                        
                        if (currentLocale === lang) {
                            console.log(`Setting selected index to ${index}`);
                            localeSelect.selectedIndex = index;
                        }
                    });
                    
                    console.log('Final selected index:', localeSelect.selectedIndex);

                    // Navigate immediately when locale is changed
                    localeSelect.addEventListener('change', function() {
                        console.log('Language changed to:', this.value);
                        window.location.href = this.value;
                    });
        </script>
            
        
    </div>
</div>
 {% endblock %}