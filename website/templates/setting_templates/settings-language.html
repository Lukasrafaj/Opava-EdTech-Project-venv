{% extends "base.html" %}
{% block title %}Login{% endblock %}



{% block content_section %}

<div class="div-settings-container">

    <div class="div-settings-menu">
                <div class="divider"></div>
                <button class="menu-item" id="NameChange">
                    <span class="menu-icon">&#128100;</span>
                    <span>{{ _('Name') }}</span>
                </button>
                <div class="divider"></div>
                <button class="menu-item" id="EmailChange">
                    <span class="menu-icon">&#128231;</span>
                    <span>{{ _('Email') }}</span>
                </button>
                <div class="divider"></div>
                <button class="menu-item" id="PasswordChange">
                    <span class="menu-icon">&#128274;</span>
                    <span>{{ _('Password') }}</span>
                </button>
                <div class="divider"></div>
                <button class="menu-item" id="LanguageChange">
                    <span class="menu-icon">{{ flags[current_locale] }}</span>
                    <span>{{ _('Language') }}</span>
                </button>
                <div class="divider"></div>

    </div>
   
   
    <div class="div-settings-content">

        <div class = "div-sign-up-container">
            
            <h1 class = "header-sign-up" align="center">{{ _('Select language') }}</h1>
            <div class="divider"></div>
                <div class="div-register-form">
                    
                        <label class="label-register" for="localeSelect">{{ _('Choose a locale:') }}</label>
                        <div class="language-selector">
                            <button class="language-btn" id="languageBtn" type="button">
                                <span id="currentLangFlag">ðŸ‡¬ðŸ‡§</span>
                                <span id="currentLangName">English</span>
                            </button>
                            
                            <div class="language-options" id="languageOptions">
                                <div class="language-option" data-lang="en" data-url="{{ url_for('lang.set_language', lang='en') }}">
                                    ðŸ‡¬ðŸ‡§ English
                                </div>
                                <div class="language-option" data-lang="cs" data-url="{{ url_for('lang.set_language', lang='cs') }}">
                                    ðŸ‡¨ðŸ‡¿ Czech
                                </div>
                                <div class="language-option" data-lang="sk" data-url="{{ url_for('lang.set_language', lang='sk') }}">
                                    ðŸ‡¸ðŸ‡° Slovak
                                </div>
                            </div>
                        </div>
                    
                </div>
        </div>
        
        
        <script>
                (function() {
                    const currentLocale = "{{ session.get('lang', 'en') }}";
                    const languageBtn = document.getElementById('languageBtn');
                    const languageOptions = document.getElementById('languageOptions');
                    const currentLangFlag = document.getElementById('currentLangFlag');
                    const currentLangName = document.getElementById('currentLangName');
                    
                    const langMap = {
                        'en': { flag: 'ðŸ‡¬ðŸ‡§', name: 'English' },
                        'cs': { flag: 'ðŸ‡¨ðŸ‡¿', name: 'Czech' },
                        'sk': { flag: 'ðŸ‡¸ðŸ‡°', name: 'Slovak' }
                    };
                    
                    console.log('Language selector initialized');
                    console.log('Current locale:', currentLocale);
                    
                    // Set current language display
                    if (langMap[currentLocale]) {
                        currentLangFlag.textContent = langMap[currentLocale].flag;
                        currentLangName.textContent = langMap[currentLocale].name;
                    }
                    
                    // Highlight active language option
                    const options = document.querySelectorAll('.language-option');
                    options.forEach(option => {
                        const lang = option.getAttribute('data-lang');
                        if (lang === currentLocale) {
                            option.classList.add('active');
                        }
                        
                        // Add click handler
                        option.addEventListener('click', function() {
                            const url = this.getAttribute('data-url');
                            console.log('Navigating to:', url);
                            window.location.href = url;
                        });
                    });
                    
                    // Toggle dropdown
                    languageBtn.addEventListener('click', function(e) {
                        console.log('Button clicked!');
                        e.preventDefault();
                        e.stopPropagation();
                        const isShowing = languageOptions.classList.contains('show');
                        console.log('Currently showing:', isShowing);
                        languageOptions.classList.toggle('show');
                        console.log('After toggle:', languageOptions.classList.contains('show'));
                    });
                    
                    // Close dropdown when clicking outside
                    document.addEventListener('click', function(e) {
                        if (!languageBtn.contains(e.target) && !languageOptions.contains(e.target)) {
                            languageOptions.classList.remove('show');
                        }
                    });
                })();
        </script>
            
        
    </div>
</div>
 {% endblock %}